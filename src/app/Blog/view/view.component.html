<div class="max-w-2xl mx-auto p-4 space-y-6">
  <div *ngFor="let tmp of blogs" class="bg-white shadow-lg rounded-2xl p-6">
    <!-- Autor + fecha -->
    <div class="flex items-center space-x-3 mb-3">
      <img src="https://i.pravatar.cc/40" class="w-10 h-10 rounded-full" alt="avatar" />
      <div>
        <a [routerLink]="['/blog/myprofile', tmp.blog.author.id]"
           class="font-semibold text-blue-600 hover:underline cursor-pointer">
          {{ tmp.blog.author.name }}
        </a>
        <p class="text-sm text-gray-500">
          {{ tmp.blog.date | date: 'short' }}
        </p>
        <p class="text-sm text-gray-500">
          {{ tmp.blog.type }}
        </p>
      </div>
    </div>

    <!-- TÃ­tulo -->
    <h2 class="text-lg font-bold text-gray-800 mb-2">
      <a [routerLink]="['/blog/viewDetail', tmp.blog.id]"
         class="font-semibold text-blue-600 hover:underline cursor-pointer">
        {{ tmp.blog.name }}
      </a>
    </h2>

    <!-- Imagen del post (si existe) -->
    <ng-container *ngIf="tmp.blog.image as img">
      <div class="mt-3 overflow-hidden rounded-xl border border-gray-200 bg-gray-50">
        <img
          [src]="
            img.startsWith('http') ? img :
            (img.startsWith('data:') ? img : 'data:image/jpeg;base64,' + img)
          "
          alt="Imagen de {{ tmp.blog.name }}"
          class="w-full h-64 object-cover"
          loading="lazy"
          referrerpolicy="no-referrer"
        />
      </div>
    </ng-container>

    <!-- Acciones -->
    <div class="flex space-x-6 text-gray-600 text-sm mt-3">
      <button type="button" (click)="toggleLike(tmp)" class="group inline-flex items-center gap-1 transition"
              [class.text-red-600]="isLiked(tmp)" [attr.aria-pressed]="isLiked(tmp)"
              [title]="isLiked(tmp) ? 'Quitar me gusta' : 'Me gusta'">
        <!-- icono lleno -->
        <svg *ngIf="isLiked(tmp)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
             class="h-5 w-5 fill-current">
          <path d="M12 21s-6.716-4.407-9.327-7.018A6.6 6.6 0 0 1 3.27 3.27a6.2 6.2 0 0 1 8.73 0L12 3.77l.001-.001a6.2 6.2 0 0 1 8.73 8.73C18.716 16.593 12 21 12 21z"/>
        </svg>
        <!-- contorno -->
        <svg *ngIf="!isLiked(tmp)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
             class="h-5 w-5 stroke-current" fill="none" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M21 8.25c0-2.899-2.351-5.25-5.25-5.25A5.246 5.246 0 0 0 12 5.114 5.246 5.246 0 0 0 8.25 3C5.351 3 3 5.351 3 8.25c0 6.364 9 11.25 9 11.25s9-4.886 9-11.25z"/>
        </svg>
        <span class="font-medium">{{ tmp.likes.length || 0 }}</span>
      </button>

      <button (click)="toggleComments(tmp)" class="hover:text-blue-500">
        ðŸ’¬ Comentarios ({{ tmp.comments.length }})
      </button>

      <button (click)="shared(tmp.blog)" class="hover:text-blue-500">ðŸ”— Compartir</button>
    </div>

    <!-- Comentarios -->
    <div *ngIf="tmp.view" class="mt-4 space-y-3">
      <div *ngFor="let comment of tmp.comments" class="border-t pt-2 text-sm text-gray-700">
        <strong>{{ comment.user.name }}:</strong> {{ comment.content }}
      </div>

      <div class="flex mt-2">
        <input [(ngModel)]="newComment[tmp.blog.id!]" type="text" placeholder="Escribe un comentario..."
               class="border rounded-l-lg p-2 w-full focus:ring-2 focus:ring-blue-500" />
        <button (click)="addComment(tmp.blog.id)"
                class="bg-blue-600 text-white px-4 rounded-r-lg hover:bg-blue-700 transition">
          Enviar
        </button>
      </div>
    </div>
  </div>
</div>
